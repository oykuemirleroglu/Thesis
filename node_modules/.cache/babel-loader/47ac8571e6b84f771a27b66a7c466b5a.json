{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\xD6yk\\xFC\\\\Desktop\\\\CENG-416\\\\src\\\\pages\\\\LoginPage.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport \"../App.css\";\nimport { LockClosedIcon } from \"@heroicons/react/solid\";\nimport logo from \"../components/Logo.png\";\nimport { signInWithPopup, signInWithEmailAndPassword, GoogleAuthProvider, signInWithRedirect, getRedirectResult } from \"firebase/auth\";\nimport { auth, provider } from \"../database/firebase-config\";\nimport AuthContext from \"../store/authContext\";\nimport { DatabaseHandler } from \"../database/DatabaseHandler\";\nimport Alert from \"../UI/Alert\";\nimport RedirectinBanner from \"../UI/RedirectingBanner\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialError = {\n  isError: false,\n  errorCode: \"\",\n  errorMessages: []\n};\nexport default function SignInPage(props) {\n  _s();\n\n  const [inputs, setInputs] = useState({});\n  const [error, setError] = useState(initialError);\n  const [redirecting, setRedirecting] = useState(true);\n  const authCtx = useContext(AuthContext);\n  const navigate = useNavigate();\n  useEffect(() => {\n    getRedirectResult(auth).then(result => {\n      const credential = GoogleAuthProvider.credentialFromResult(result);\n      const token = credential.accessToken;\n      const user = result.user;\n      localStorage.setItem(\"uid\", user.uid);\n      localStorage.setItem(\"userInfo\", JSON.stringify({\n        email: user.email,\n        userName: user.displayName\n      }));\n      DatabaseHandler.registerUserData(user.uid, user.displayName, user.email, \"null\", \"null\");\n      authCtx.onLogin();\n      navigate(\"/\");\n      setRedirecting(false);\n    }).catch(e => {\n      setRedirecting(false);\n      const errorCode = error.code;\n      const errorMessage = error.message; // The email of the user's account used.\n\n      const email = error.customData.email; // The AuthCredential type that was used.\n\n      const credential = GoogleAuthProvider.credentialFromError(error);\n      setError(error => ({\n        isError: true,\n        errorCode: errorCode,\n        errorMessages: [...error.errorMessages, errorMessage]\n      }));\n    });\n  }, []);\n\n  const handleChange = event => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setInputs(values => ({ ...values,\n      [name]: value\n    }));\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    console.log(inputs);\n    signInWithEmailAndPassword(auth, inputs.email, inputs.password).then(async userCredential => {\n      // Signed in\n      const user = userCredential.user;\n      console.log(user);\n      const userName = await DatabaseHandler.getUserName(user.uid); // Critical ! I should look again. undefined\n\n      console.log(userName);\n      localStorage.setItem(\"uid\", user.uid);\n      localStorage.setItem(\"userInfo\", JSON.stringify({\n        email: user.email,\n        userName: userName\n      }));\n      authCtx.onLogin();\n      navigate(\"/\");\n    }).catch(error => {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      setError(error => ({\n        isError: true,\n        errorCode: errorCode,\n        errorMessages: [...error.errorMessages, errorMessage]\n      }));\n      console.log(errorCode, errorMessage);\n    });\n  };\n\n  const googleHandler = () => {\n    //signInWithRedirect(auth, provider);\n    signInWithPopup(auth, provider).then(result => {\n      const credential = GoogleAuthProvider.credentialFromResult(result);\n      const token = credential.accessToken;\n      const user = result.user;\n      console.log(user, user.uid);\n      localStorage.setItem(\"uid\", user.uid);\n      localStorage.setItem(\"userInfo\", JSON.stringify({\n        email: user.email,\n        userName: user.displayName\n      }));\n      DatabaseHandler.registerUserData(user.uid, user.displayName, user.email, \"null\", \"null\");\n      authCtx.onLogin();\n      navigate(\"/\");\n    }).catch(error => {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      const email = error.email;\n      const credential = GoogleAuthProvider.credentialFromError(error);\n      console.log(errorCode, errorMessage, email, credential);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [redirecting && /*#__PURE__*/_jsxDEV(RedirectinBanner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 23\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-md w-full space-y-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"mx-auto h-50 w-72\",\n            src: logo,\n            alt: \"logo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"mt-6 text-center text-3xl font-extrabold text-gray-900\",\n            children: \"Sign in to your account\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"mt-8 space-y-6\",\n          action: \"/home\",\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rounded-md shadow-sm -space-y-px\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-6 w-6\",\n                fill: \"none\",\n                viewBox: \"0 0 24 15\",\n                stroke: \"currentColor\",\n                \"stroke-width\": \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"sr-only\",\n                children: \"Email address\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"email\",\n                value: inputs.email,\n                onChange: handleChange,\n                required: true,\n                className: \"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\",\n                placeholder: \"Email address\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-6 w-6\",\n                fill: \"none\",\n                viewBox: \"0 0 24 18\",\n                stroke: \"currentColor\",\n                \"stroke-width\": \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"sr-only\",\n                children: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"password\",\n                value: inputs.password || \"\",\n                onChange: handleChange,\n                required: true,\n                className: \"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\",\n                placeholder: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 13\n          }, this), error.isError && /*#__PURE__*/_jsxDEV(Alert, {\n            title: error.errorCode,\n            status: \"err\",\n            messages: error.errorMessages\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm\",\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/forget-password\",\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"font-medium text-blue-700 hover:text-blue-500\",\n                  children: \"Forgot password?\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 228,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              id: \"sub_btn\",\n              className: \"group relative w-full flex justify-center py-3 px-4 border border-transparent text-base font-medium rounded-md text-white bg-blue-700 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",\n              type: \"submit\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"absolute left-0 inset-y-0 flex items-center pl-5\",\n                children: /*#__PURE__*/_jsxDEV(LockClosedIcon, {\n                  className: \"h-7 w-7 text-blue-500 group-hover:text-blue-700\",\n                  \"aria-hidden\": \"true\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 17\n              }, this), \"Sign in\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"group relative w-full flex justify-center py-3 px-4 border border-transparent text-base font-medium rounded-md text-white bg-blue-700 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",\n              type: \"button\",\n              onClick: googleHandler,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"absolute left-0 inset-y-0 flex items-center pl-5\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: \"https://img.icons8.com/ios-filled/30/000000/google-logo.png\",\n                  alt: \"google icon\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 256,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 17\n              }, this), \"Continue with Google\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-1xl  text-gray-900\",\n              children: [\"Don't have an account yet? \\xA0\", /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/registerPage\",\n                className: \"inline-flex items-center px-3 py-2 border border-transparent text-base font-medium rounded-full shadow-sm text-black bg-green-500 hover:bg-green-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-400\",\n                children: \"Sign up\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(SignInPage, \"2zjQidX8D9CXkhvyvwXoZto3rmw=\", false, function () {\n  return [useNavigate];\n});\n\n_c = SignInPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignInPage\");","map":{"version":3,"sources":["C:/Users/Öykü/Desktop/CENG-416/src/pages/LoginPage.jsx"],"names":["React","useState","useContext","useEffect","Link","useNavigate","LockClosedIcon","logo","signInWithPopup","signInWithEmailAndPassword","GoogleAuthProvider","signInWithRedirect","getRedirectResult","auth","provider","AuthContext","DatabaseHandler","Alert","RedirectinBanner","initialError","isError","errorCode","errorMessages","SignInPage","props","inputs","setInputs","error","setError","redirecting","setRedirecting","authCtx","navigate","then","result","credential","credentialFromResult","token","accessToken","user","localStorage","setItem","uid","JSON","stringify","email","userName","displayName","registerUserData","onLogin","catch","e","code","errorMessage","message","customData","credentialFromError","handleChange","event","name","target","value","values","handleSubmit","preventDefault","console","log","password","userCredential","getUserName","googleHandler"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport \"../App.css\";\nimport { LockClosedIcon } from \"@heroicons/react/solid\";\nimport logo from \"../components/Logo.png\";\nimport {\n  signInWithPopup,\n  signInWithEmailAndPassword,\n  GoogleAuthProvider,\n  signInWithRedirect,\n  getRedirectResult,\n} from \"firebase/auth\";\nimport { auth, provider } from \"../database/firebase-config\";\nimport AuthContext from \"../store/authContext\";\nimport { DatabaseHandler } from \"../database/DatabaseHandler\";\nimport Alert from \"../UI/Alert\";\nimport RedirectinBanner from \"../UI/RedirectingBanner\";\n\nconst initialError = {\n  isError: false,\n  errorCode: \"\",\n  errorMessages: [],\n};\n\nexport default function SignInPage(props) {\n  const [inputs, setInputs] = useState({});\n  const [error, setError] = useState(initialError);\n  const [redirecting, setRedirecting] = useState(true);\n\n  const authCtx = useContext(AuthContext);\n  const navigate = useNavigate();\n\n  useEffect(()=>{\n    getRedirectResult(auth)\n        .then((result) => {\n          const credential = GoogleAuthProvider.credentialFromResult(result);\n          const token = credential.accessToken;\n          const user = result.user;\n               localStorage.setItem(\"uid\", user.uid);\n        localStorage.setItem(\n          \"userInfo\",\n          JSON.stringify({\n            email: user.email,\n            userName: user.displayName,\n          })\n        );\n        DatabaseHandler.registerUserData(\n          user.uid,\n          user.displayName,\n          user.email,\n          \"null\",\n          \"null\"\n        );\n        authCtx.onLogin();\n        navigate(\"/\");\n        setRedirecting(false)\n        })\n        .catch((e) => {\n          setRedirecting(false);\n          const errorCode = error.code;\n          const errorMessage = error.message;\n          // The email of the user's account used.\n          const email = error.customData.email;\n          // The AuthCredential type that was used.\n          const credential = GoogleAuthProvider.credentialFromError(error);\n          setError((error) => ({\n            isError: true,\n            errorCode: errorCode,\n            errorMessages: [...error.errorMessages, errorMessage],\n          }));\n        });\n  },[])\n\n  const handleChange = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setInputs((values) => ({ ...values, [name]: value }));\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    console.log(inputs);\n    signInWithEmailAndPassword(auth, inputs.email, inputs.password)\n      .then(async (userCredential) => {\n        // Signed in\n        const user = userCredential.user;\n        console.log(user);\n        const userName = await DatabaseHandler.getUserName(user.uid); // Critical ! I should look again. undefined\n        console.log(userName);\n        localStorage.setItem(\"uid\", user.uid);\n        localStorage.setItem(\n          \"userInfo\",\n          JSON.stringify({ email: user.email, userName: userName })\n        );\n        authCtx.onLogin();\n\n        navigate(\"/\");\n      })\n      .catch((error) => {\n        const errorCode = error.code;\n        const errorMessage = error.message;\n\n        setError((error) => ({\n          isError: true,\n          errorCode: errorCode,\n          errorMessages: [...error.errorMessages, errorMessage],\n        }));\n        console.log(errorCode, errorMessage);\n      });\n  };\n\n  const googleHandler = () => {\n    //signInWithRedirect(auth, provider);\n    signInWithPopup(auth, provider)\n      .then((result) => {\n        const credential = GoogleAuthProvider.credentialFromResult(result);\n        const token = credential.accessToken;\n        const user = result.user;\n        console.log(user, user.uid);\n        localStorage.setItem(\"uid\", user.uid);\n        localStorage.setItem(\n          \"userInfo\",\n          JSON.stringify({\n            email: user.email,\n            userName: user.displayName,\n          })\n        );\n        DatabaseHandler.registerUserData(\n          user.uid,\n          user.displayName,\n          user.email,\n          \"null\",\n          \"null\"\n        );\n        authCtx.onLogin();\n        navigate(\"/\");\n      })\n      .catch((error) => {\n        const errorCode = error.code;\n        const errorMessage = error.message;\n        const email = error.email;\n        const credential = GoogleAuthProvider.credentialFromError(error);\n        console.log(errorCode, errorMessage, email, credential);\n      });\n  };\n\n  return (\n    <>\n      {redirecting && <RedirectinBanner/>}\n      <div className=\"min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\n        <div className=\"max-w-md w-full space-y-8\">\n          <div>\n            <img className=\"mx-auto h-50 w-72\" src={logo} alt=\"logo\" />\n            <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n              Sign in to your account\n            </h2>\n          </div>\n          <form\n            className=\"mt-8 space-y-6\"\n            action=\"/home\"\n            onSubmit={handleSubmit}\n          >\n            <div className=\"rounded-md shadow-sm -space-y-px\">\n              <div className=\"flex\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  class=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 15\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"2\"\n                >\n                  <path\n                    stroke-linecap=\"round\"\n                    stroke-linejoin=\"round\"\n                    d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\n                  />\n                </svg>\n                <label className=\"sr-only\">Email address</label>\n                <input\n                  type=\"text\"\n                  name=\"email\"\n                  value={inputs.email}\n                  onChange={handleChange}\n                  required\n                  className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\n                  placeholder=\"Email address\"\n                />\n              </div>\n              <div className=\"flex\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  class=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 18\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"2\"\n                >\n                  <path\n                    stroke-linecap=\"round\"\n                    stroke-linejoin=\"round\"\n                    d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\"\n                  />\n                </svg>\n                <label className=\"sr-only\">Password</label>\n                <input\n                  type=\"password\"\n                  name=\"password\"\n                  value={inputs.password || \"\"}\n                  onChange={handleChange}\n                  required\n                  className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\n                  placeholder=\"Password\"\n                />\n              </div>\n            </div>\n            {error.isError && (\n              <Alert\n                title={error.errorCode}\n                status=\"err\"\n                messages={error.errorMessages}\n              />\n            )}\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center\"></div>\n              <div className=\"text-sm\">\n                <Link to=\"/forget-password\">\n                  <label className=\"font-medium text-blue-700 hover:text-blue-500\">\n                    Forgot password?\n                  </label>\n                </Link>\n              </div>\n            </div>\n\n            <div>\n              <button\n                id=\"sub_btn\"\n                className=\"group relative w-full flex justify-center py-3 px-4 border border-transparent text-base font-medium rounded-md text-white bg-blue-700 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n                type=\"submit\"\n              >\n                <span className=\"absolute left-0 inset-y-0 flex items-center pl-5\">\n                  <LockClosedIcon\n                    className=\"h-7 w-7 text-blue-500 group-hover:text-blue-700\"\n                    aria-hidden=\"true\"\n                  />\n                </span>\n                Sign in\n              </button>\n              <br />\n              <button\n                className=\"group relative w-full flex justify-center py-3 px-4 border border-transparent text-base font-medium rounded-md text-white bg-blue-700 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n                type=\"button\"\n                onClick={googleHandler}\n              >\n                <span className=\"absolute left-0 inset-y-0 flex items-center pl-5\">\n                  <img\n                    src=\"https://img.icons8.com/ios-filled/30/000000/google-logo.png\"\n                    alt=\"google icon\"\n                  />\n                </span>\n                Continue with Google\n              </button>\n              <br />\n              <div className=\"text-center text-1xl  text-gray-900\">\n                Don't have an account yet? &nbsp;\n                <Link\n                  to=\"/registerPage\"\n                  className=\"inline-flex items-center px-3 py-2 border border-transparent text-base font-medium rounded-full shadow-sm text-black bg-green-500 hover:bg-green-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-400\"\n                >\n                  Sign up\n                </Link>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}